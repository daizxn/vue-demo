import{_ as k,c as h,a as r,t as d,F as $,r as A,o as m,d as v,e as U,f as I,b as j}from"./index-BQfY6pwd.js";const st="/vue-demo/title-banner.png",R={class:"highlight-card"},H={class:"date-range"},N={class:"highlight-text"},T={class:"highlight-title"},V={class:"highlight-links"},B=["href"],E={__name:"HighlightSection",props:{startDate:{type:String,required:!0},endDate:{type:String,required:!0},period:{type:String,required:!0},title:{type:String,default:"本期 Highlight"},links:{type:Array,required:!0,validator(n){return n.every(i=>i.url&&i.text&&i.section)}}},setup(n){return(i,x)=>(m(),h("div",R,[r("div",H,d(n.startDate)+" - "+d(n.endDate)+" 第 "+d(n.period)+" 期",1),r("div",N,[r("div",T,d(n.title),1),r("div",V,[r("ol",null,[(m(!0),h($,null,A(n.links,(a,_)=>(m(),h("li",{key:_},[r("span",null,d(_+1)+". ",1),r("span",null,"【"+d(a.section)+"】",1),r("a",{href:a.url,target:"_blank"},d(a.text),9,B)]))),128))])])])]))}},ot=k(E,[["__scopeId","data-v-ec225528"]]),F={class:"card-content"},O={class:"card-title"},K={class:"card-description"},M={class:"caed-from"},W=["src"],z={__name:"LinkCard",props:{url:{type:String,required:!0},title:{type:String},description:{type:String},image:{type:String}},setup(n){const i=v(""),x=v(""),a=v(""),_=v(""),S=v(!1),s=n,L=()=>{s.url?window.open(s.url,"_blank"):alert("链接无效")};return U(async()=>{var b,y;{if(!s.url){alert("请提供一个有效的链接");return}try{let C=function(t){if(!t.src)return!1;const f=[/\.png$/i,/transparent/i,/alpha/i,/overlay/i,/watermark/i];for(const e of f)if((e.test(t.src)||e.test(t.alt))&&(!e.test(t.src)||t.src.includes(".png")))return!1;const l=[/logo/i,/icon/i,/avatar/i,/ad[_-]/i,/banner/i,/button/i,/pixel/i,/1x1/i,/tracking/i,/spacer/i,/blank/i,/clear/i];for(const e of l)if(e.test(t.src)||e.test(t.alt)||e.test(t.className))return!1;return t.src.match(/\.(jpg|jpeg)$/i)?!0:[/article/i,/photo/i,/image/i,/picture/i,/content/i].some(e=>e.test(t.src)||e.test(t.alt))};const P=await(await fetch(`https://api.allorigins.win/raw?url=${encodeURIComponent(s.url)}`)).text(),c=new DOMParser().parseFromString(P,"text/html");let w="",g="",o="",q="";if(typeof s.title>"u"){let t="";const f=c.querySelectorAll("h1");for(const l of f){const u=l.textContent.trim();if(u.length>5&&u.length<200){t=u;break}}if(!t){const l=["h1",".article-title",".post-title",".title",'[class*="title"]',"h2"];for(const u of l){const e=c.querySelector(u);if(e){const p=e.textContent.trim();if(p.length>5&&p.length<200){t=p;break}}}}w=t||(c.querySelector("title")?c.querySelector("title").textContent.trim():"未找到标题")}else w=s.title;if(typeof s.description>"u"){if(g=c.querySelector('meta[name="description"]')?c.querySelector('meta[name="description"]').getAttribute("content"):"",!g){const t=c.querySelectorAll("p");let f="";for(const l of t){const u=l.textContent.trim();if(u.length>20&&(f+=u+" ",f.length>200))break}g=f.trim()}g&&(g=g.replace(/\s+/g," ").slice(0,100)+(g.length>100?"...":""))}else g=s.description;if(typeof s.image>"u"){let t=(b=c.querySelector('meta[property="og:image"]'))==null?void 0:b.getAttribute("content"),f=(y=c.querySelector('meta[name="twitter:image"]'))==null?void 0:y.getAttribute("content"),l="";const u=["article img",".article-content img",".post-content img",".content img","main img"];for(const e of u){const p=c.querySelector(e);if(p&&C(p)){l=p.src;break}}if(!l){const e=c.querySelectorAll("img");for(const p of e)if(C(p)){l=p.src;break}}if(o=t||f||l||"",console.log(imageContentll),o){if(!o.startsWith("http"))try{const e=new URL(s.url);o=new URL(o,e.origin).href}catch{o=""}o&&(o=`https://wsrv.nl/?url=${encodeURIComponent(o)}`)}}else o=s.image;o===""?S.value=!1:S.value=!0,q=new URL(s.url).hostname,i.value=w,x.value=g,a.value=o,_.value=q}catch{alert("无法获取链接数据")}}}),(b,y)=>(m(),h("div",{class:"card",onClick:L},[r("div",F,[r("h3",O,d(i.value),1),r("div",null,[r("p",K,d(x.value),1),r("div",M,[y[0]||(y[0]=r("p",null,"来自：",-1)),y[1]||(y[1]=r("p",null,null,-1)),r("p",null,d(_.value),1)])])]),S.value?(m(),h("img",{key:0,src:a.value,alt:"Image",class:"card-image"},null,8,W)):I("",!0)]))}},G=k(z,[["__scopeId","data-v-d0a951a4"]]),J={class:"article-card"},Q={class:"article-text"},X={class:"article-title"},Y={style:{"padding-top":"16px","padding-bottom":"32px"}},Z={key:0,class:"article-news-line"},tt={__name:"ArticleCard",props:{title:{type:String,required:!0},news:{type:Array,required:!0,validator:function(n){return n.length===0?!1:n.every(i=>i&&typeof i=="object"&&i.url&&i.url.trim()!=="")}}},setup(n){return(i,x)=>(m(),h("div",J,[r("div",Q,[r("div",X,d(n.title),1),r("div",Y,[(m(!0),h($,null,A(n.news,(a,_)=>(m(),h("div",{class:"article-news",key:_},[j(G,{url:a.url,title:a.title,description:a.description,image:a.image},null,8,["url","title","description","image"]),_<n.news.length-1?(m(),h("div",Z)):I("",!0)]))),128))])])]))}},lt=k(tt,[["__scopeId","data-v-f4ff83e6"]]);export{lt as A,ot as H,st as _};
